package com.ksv.producer.kafka; import org.apache.kafka.clients.producer.*; import org.apache.kafka.common.*; import java.nio.charset.*; import java.util.*; import java.util.zip.*; public class ReverseKeyPartitioner implements Partitioner { public void configure(Map<String,?> c){} public int partition(String t,Object k,byte[] kb,Object v,byte[] vb,Cluster cl){ int p=cl.partitionsForTopic(t).size(); if(k==null) return 0; String r=new StringBuilder(k.toString()).reverse().toString(); CRC32 crc=new CRC32(); crc.update(r.getBytes(StandardCharsets.UTF_8)); return (int)(Math.abs(crc.getValue())%p);} public void close(){} }