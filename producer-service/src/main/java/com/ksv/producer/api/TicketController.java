package com.ksv.producer.api; import com.ksv.producer.domain.*; import com.ksv.producer.kafka.*; import jakarta.validation.*; import org.springframework.beans.factory.annotation.*; import org.springframework.http.*; import org.springframework.web.bind.annotation.*; import java.time.*; import java.util.*; @RestController @RequestMapping("/api/tickets") public class TicketController { private final EventPublisher publisher; @Value("${app.topics.ticket-created}") private String topic; public TicketController(EventPublisher p){ this.publisher=p; } @PostMapping public ResponseEntity<?> create(@Valid @RequestBody TicketCreateRequest req){ var e=new TicketCreatedEvent(UUID.randomUUID().toString(),req.customerId(),req.title(),req.priority(),Instant.now()); String cid=publisher.publish(e); return ResponseEntity.accepted().body(Map.of("topic",topic,"eventId",e.eventId(),"correlationId",cid)); } }